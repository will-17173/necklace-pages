var featuredimagezoomer={loadinggif:"/images/spinningred.gif",magnifycursor:"crosshair"};!function($){$("head").append('<style type="text/css">.featuredimagezoomerhidden {visibility: hidden!important;}</style>'),$.fn.multizoomhide=function(){return $('<style type="text/css">'+this.selector+" {visibility: hidden;}</style>").appendTo("head")},$.fn.addmultizoom=function(options){function loadfunction(){var e,t,i,o,a,s=this,r={},n={};(e=s.getAttribute("data-dims"))&&(e=e.split(splitre),o=e[0],a=e[1]),$(new Image).error(function(){s.tagName&&!options.notmulti&&(console?console.error("Error: I couldn't find the image:\n\n"+s.href+((t=s.getAttribute("data-title"))?'\n\n"'+t+'"':"")):alert("Error: I couldn't find the image:\n\n"+s.href+((t=s.getAttribute("data-title"))?'\n\n"'+t+'"':"")),(i=$imgObj.data("last-trigger"))&&(first=!0,$(i).trigger("click")))}).load(function(){var e,t=$imgObj.css("opacity"),i={};isNaN(t)&&(t=1),(options.notmulti||!indoptions.largeimage)&&(o=options.width||$imgObj.width(),a=options.height||$imgObj.height()),$imgObj.attr("src",this.src).css({width:o||options.width||this.width,height:a=+(a||options.height||this.height)}),$imgObj.data("added")&&$imgObj.data("added").remove(),$imgObj.data("last-trigger",s),options.imagevertcenter&&(r={top:($imgObj.parent().innerHeight()-a)/2}),$imgObj.css(r).addimagezoom($.extend(i,options,indoptions)).data("added",$(".magnifyarea:last"+(i.cursorshade?", .cursorshade:last":"")+", .zoomstatus:last, .zoomtracker:last")),options.magvertcenter&&$(".magnifyarea:last").css({marginTop:(a-$(".magnifyarea:last").height())/2}),options.descpos&&(e=$imgObj.parent(),n={left:e.offset().left+(e.outerWidth()-e.width())/2,top:a+$imgObj.offset().top}),options.notmulti?$descArea.css(n):$descArea.css(n).empty().append(s.getAttribute("data-title")||""),1>+t&&$imgObj.add($descArea).animate({opacity:1},options.speed)}).attr("src",$imgObj.data("src"))}var indoptions={largeimage:options.largeimage},$imgObj=$(options.imgObj+':not(".thumbs")'),$descArea=$(options.descArea),first=!0,splitre=/, ?/;return options=$.extend({speed:"slow",initzoomablefade:!0,zoomablefade:!0},options),this.click(function(e){e.preventDefault();var src=$imgObj.attr("src"),ms,zr,cs,opacityObj={opacity:0};(first||src!==this.href&&src!==this.getAttribute("href"))&&((first&&!options.initzoomablefade||!options.zoomablefade)&&(opacityObj={}),first=!1,indoptions.largeimage=this.getAttribute("data-large")||options.largeimage||"","none"===indoptions.largeimage&&(indoptions.largeimage=""),(ms=this.getAttribute("data-magsize"))||options.magnifiersize?indoptions.magnifiersize=(ms?ms.split(splitre):"")||options.magnifiersize:delete indoptions.magnifiersize,indoptions.zoomrange=((zr=this.getAttribute("data-zoomrange"))?zr=zr.split(splitre):"")||options.zoomrange||"",zr&&(zr[0]=+zr[0],zr[1]=+zr[1]),indoptions.cursorshade=((cs=this.getAttribute("data-lens"))?cs:"")||options.cursorshade||"",cs&&(indoptions.cursorshade=eval(cs)),$imgObj.data("added")&&$imgObj.stop(!0,!0).data("added").not(".zoomtracker").remove().end().css({background:"url("+featuredimagezoomer.loadinggif+") center no-repeat"}),$imgObj.css($.extend({visibility:"visible"},$imgObj.data("added")&&options.zoomablefade?{opacity:.25}:opacityObj)).data("src",this.href),$descArea.css($.extend({visibility:"visible"},opacityObj)),loadfunction.call(this))}).eq(0).trigger("click"),this},$.extend(featuredimagezoomer,{dsetting:{magnifierpos:"right",magnifiersize:[200,200],cursorshadecolor:"#fff",cursorshadeopacity:.3,cursorshadeborder:"1px solid black",cursorshade:!1,leftoffset:15,rightoffset:10},isie:function(){return!1}(),showimage:function(e,t,i){var o=e.data("specs"),a=o.magpos,s=this,r=e.data("specs").coords;o.windimensions={w:$(window).width(),h:$(window).height()};var n={};n.left=r.left+("left"===a?-o.magsize.w-o.lo:e.width()+o.ro),"left"!==a&&n.left+o.magsize.w+o.lo>=o.windimensions.w&&r.left-o.magsize.w>=o.lo?n.left=r.left-o.magsize.w-o.lo:"left"===a&&n.left<o.ro&&(n.left=r.left+e.width()+o.ro),t.css({left:n.left,top:r.top}).show(),o.$statusdiv.html("Current Zoom: "+o.curpower+'<div style="font-size:80%">Use Mouse Wheel to Zoom In/Out</div>'),i&&s.showstatusdiv(o,400,2e3)},hideimage:function(e,t,i){var o=e.data("specs");t.hide(),i&&this.hidestatusdiv(o)},showstatusdiv:function(e,t,i){clearTimeout(e.statustimer),e.$statusdiv.css({visibility:"visible"}).fadeIn(t),e.statustimer=setTimeout(function(){featuredimagezoomer.hidestatusdiv(e)},i)},hidestatusdiv:function(e){e.$statusdiv.stop(!0,!0).hide()},getboundary:function(e,t,i){if("left"==e){var o=-i.imagesize.w*i.curpower+i.magsize.w;return t>0?0:o>t?o:t}var a=-i.imagesize.h*i.curpower+i.magsize.h;return t>0?0:a>t?a:t},moveimage:function(e,t,i,o){var a=e.data("specs"),s=Math.round(a.magsize.w/a.curpower),r=Math.round(a.magsize.h/a.curpower),n=a.csborder,d=this,m=a.coords,l=o.pageX||a.lastpagex,g=o.pageY||a.lastpagey,c=l-m.left,u=g-m.top;i.css({visibility:"",width:s,height:r,top:Math.min(a.imagesize.h-r-n,Math.max(0,u-(n+r)/2))+m.top,left:Math.min(a.imagesize.w-s-n,Math.max(0,c-(n+s)/2))+m.left});var p=-c*a.curpower+a.magsize.w/2,h=-u*a.curpower+a.magsize.h/2;t.css({left:d.getboundary("left",p,a),top:d.getboundary("top",h,a)}),a.$statusdiv.css({left:l-10,top:g+20}),a.lastpagex=l,a.lastpagey=g},magnifyimage:function(e,t,i){t.detail||t.wheelDelta||(t=t.originalEvent);var o=t.detail?-120*t.detail:t.wheelDelta,a=-120>=o?"out":"in",s=e.data("specs"),r=s.magnifier,n=s.imagesize,d=s.curpower,m="in"==a?Math.min(d+1,i[1]):Math.max(d-1,i[0]),l=[n.w*m,n.h*m];r.$image.css({width:l[0],height:l[1]}),s.curpower=m,s.$statusdiv.html("Current Zoom: "+s.curpower),this.showstatusdiv(s,0,500),e.trigger("mousemove")},highestzindex:function(e){var t,i=0,o=e.parents().add(e);return o.each(function(){t=$(this).css("zIndex"),t=isNaN(t)?0:+t,i=Math.max(i,t)}),i},init:function(e,t){function i(e,t){var i={w:n.width(),h:n.height()},g={w:m,h:l},c=d.zoomrange?d.zoomrange[0]:(t.width()/m).toFixed(5);a.data("specs",{$statusdiv:r,statustimer:null,magnifier:{$outer:n,$inner:e,$image:t},magsize:i,magpos:d.magnifierpos,imagesize:g,curpower:c,coords:o(),csborder:s.outerWidth(),lo:d.leftoffset,ro:d.rightoffset})}function o(){var e=a.offset();return{left:e.left,top:e.top}}var a,s,r,n,d=$.extend({},this.dsetting,t),m=e.width(),l=e.height(),g=e.offset(),c=this,u={pageX:0,pageY:0},p=d.zIndex||this.highestzindex(e);return 0===l||0===m?void $(new Image).load(function(){featuredimagezoomer.init(e,t)}).attr("src",e.attr("src")):(e.css({visibility:"visible"}),d.largeimage=d.largeimage||e.get(0).src,n=$('<div class="magnifyarea" style="position:absolute;z-index:'+p+";width:"+d.magnifiersize[0]+"px;height:"+d.magnifiersize[1]+'px;left:-10000px;top:-10000px;visibility:hidden;overflow:hidden;border:1px solid black;" />').append('<div style="position:relative;left:0;top:0;z-index:'+p+';" />').appendTo(document.body),s=d.cursorshade?$('<div class="cursorshade" style="visibility:hidden;position:absolute;left:0;top:0;z-index:'+p+';" />').css({border:d.cursorshadeborder,opacity:d.cursorshadeopacity,backgroundColor:d.cursorshadecolor}).appendTo(document.body):$("<div />"),r=$('<div class="zoomstatus preloadevt" style="position:absolute;visibility:hidden;left:0;top:0;z-index:'+p+';" />').html('<img src="'+this.loadinggif+'" />').appendTo(document.body),a=$('<div class="zoomtracker" style="cursor:progress;position:absolute;z-index:'+p+";left:"+g.left+"px;top:"+g.top+"px;height:"+l+"px;width:"+m+'px;" />').css({backgroundImage:this.isie?"url(cannotbe)":"none"}).appendTo(document.body),$(window).bind("load resize",function(){var i,o=e.offset();a.css({left:o.left,top:o.top}),t.descpos&&t.descArea&&(i=e.parent(),$(t.descArea).css({left:i.offset().left+(i.outerWidth()-i.width())/2,top:e.height()+o.top}))}),a.mouseover(function(){s.add(n).add(r).removeClass("featuredimagezoomerhidden"),a.data("premouseout",!1)}).mouseout(function(){s.add(n).add(r.not(".preloadevt")).addClass("featuredimagezoomerhidden"),a.data("premouseout",!0)}).mousemove(function(e){u.pageX=e.pageX,u.pageY=e.pageY}),void a.one("mouseover",function(){var t=n.find("div:eq(0)"),g=$('<img src="'+d.largeimage+'"/>').appendTo(t),p=featuredimagezoomer.loaded[$('<a href="'+d.largeimage+'"></a>').get(0).href],h=d.zoomrange&&d.zoomrange[1]>d.zoomrange[0],f=o();p||(e.stop(!0,!0).css({opacity:.1}),r.css({left:f.left+m/2-r.width()/2,top:f.top+l/2-r.height()/2,visibility:"visible"})),g.bind("loadevt",function(p,f){if("error"===f.type){e.css({opacity:1}).data("added").remove();var z=$('<a href="'+g.attr("src")+'"></a>').get(0).href;return alert(typeof console),void(console?console.error("Cannot find Featured Image Zoomer larger image: "+z):alert("Cannot find Featured Image Zoomer larger image:\n\n"+z))}if(featuredimagezoomer.loaded[this.src]=!0,e.css({opacity:1}),r.empty().css({border:"1px solid black",background:"#C0C0C0",padding:"4px",font:"bold 13px Arial",opacity:.8}).hide().removeClass("preloadevt"),a.data("premouseout")&&r.addClass("featuredimagezoomerhidden"),d.zoomrange){var v=[m*d.zoomrange[0],l*d.zoomrange[0]];g.css({width:v[0],height:v[1]})}i(t,g),n.css({display:"none",visibility:"visible"}),a.mouseover(function(){a.data("specs").coords=o(),c.showimage(a,n,h)}),a.mousemove(function(e){c.moveimage(a,t,s,e)}),a.data("premouseout")||(c.showimage(a,n,h),c.moveimage(a,t,s,u)),a.mouseout(function(){c.hideimage(a,n,h)}).css({cursor:c.magnifycursor}),d.zoomrange&&d.zoomrange[1]>d.zoomrange[0]?a.bind("DOMMouseScroll mousewheel",function(e){c.magnifyimage(a,e,d.zoomrange),e.preventDefault()}):d.disablewheel&&a.bind("DOMMouseScroll mousewheel",function(e){e.preventDefault()})}),g.get(0).complete?g.trigger("loadevt",{type:"load"}):g.bind("load error",function(e){g.trigger("loadevt",e)})}))},iname:function(){var e=$("<img />"),t=e.get(0).tagName;return e.remove(),t}(),loaded:{},hashre:/^#/}),$.fn.addimagezoom=function(e){var t=this.selector,i=$(t.replace(featuredimagezoomer.hashre,".")+".thumbs a");return e=e||{},null!==e.multizoom&&i.size()?(i.addmultizoom($.extend(e,{imgObj:t,multizoom:null})),this):e.multizoom?($(e.multizoom).addmultizoom($.extend(e,{imgObj:t,multizoom:null})),this):this.each(null!==e.multizoom?function(){return this.tagName!==featuredimagezoomer.iname?!0:void $('<a href="'+this.src+'"></a>').addmultizoom($.extend(e,{imgObj:t,multizoom:null,notmulti:!0}))}:function(){return this.tagName!==featuredimagezoomer.iname?!0:void featuredimagezoomer.init($(this),e)})}}(jQuery);